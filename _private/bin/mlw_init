#!/bin/bash

set -e

if [ -z "$DOCSTOR_URL" ];
then
	echo "Environment variable not set: DOCSTOR_URL"
	exit -1
fi

if [ -z "$MLW_DOCUMENT_ID" ];
then
	echo "Environment variable not set: MLW_DOCUMENT_ID"
	exit -1
fi

if [ -z "$MLW_ACCESS_TOKEN" ];
then
	echo "Environment variable not set: MLW_ACCESS_TOKEN"
	exit -1
fi

## Download the workspace document
/working/_private/node/download_mlw_document.js --doc=/working/_private/data/workspace.mlw

## Set the workspace files
/working/_private/node/update_workspace_files.js --doc=/working/_private/data/workspace.mlw --destpath=/working/workspace

## Install the python requirements
cd /working/workspace
pip3 install -r requirements.txt

## Start jupyter lab
jupyter lab --allow-root --port=8888 --ip=0.0.0.0 --NotebookApp.token=
